{% extends 'base.html' %}
{% block content %}
<!-- Include all compiled plugins (below), or include individual files as needed-->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.12/js/jquery.dataTables.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.12/js/dataTables.bootstrap.min.js"></script>
<script src="https://cdn.datatables.net/plug-ins/1.10.15/sorting/stringMonthYear.js"></script>

<head>
  <title>Gerloff Painting</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>    $( ".book_new_job" ).addClass("active");  </script>
    <script type="text/javascript">
        function check_booking_data() {
            if (booking_input.job_name.value ==""){
                alert('please enter a job name')
                return false;
                }
         }

        function filter_estimators() {
            let selectedCompany = booking_input.select_company.value
            let rolodex = JSON.parse("{{data|escapejs}}");
            console.log(selectedCompany)
            //alert()
            let estimators = []
            rolodex.forEach(rolodexItem => (rolodexItem.company == selectedCompany) &&  estimators.push(rolodexItem.estimator))
            for(let i = 0; i < estimators.length; i++){
                booking_input.select_PM.options[i] = new Option(estimators[i],estimators[i]);
            }
         }
    </script>

</head>

  <body>
  <h1>Book New Job</h1>
    <form name = booking_input action="register" method="post" onSubmit = "return check_booking_data()">
        {% csrf_token %}
        <input type="text" name="job_number" placeholder="Leave Blank (unless entering a custom job number)" maxlength="5" size="100"/><br />
        <input type="text" name="job_name" placeholder="Job Name" size="100"/><br />
        <br />
        <input type="text" name="address" placeholder="Address" size="100"/><br />
        <div class ="container">
            <div class ="row">
                <div class ="col">    <input type="text" name="city" placeholder="City" size="30"/><br />         </div>
                <div class ="col">   <input type="text" name="state" placeholder="State" size="30" /><br />       </div>
                <div class ="col"></div>
            </div>
        </div>
        <br />        <hr>
        <input type="checkbox" name ="on_base" id="on_base"  />
        <label for="on_base">"Security Clearance Required?" </label>
        <br />

        <div class ="container">
            <div class ="row">
                <div class ="col">                    <input type= "text" name="spray_scale" placeholder="Spray Scale" size="30"/><br />                </div>
                <div class ="col">                    <input type= "text" name="brush_role" placeholder="Brush/Roll Scale" size="30"/><br />                </div>
                <div class ="col"></div>
            </div>
        </div>
        <br />         <hr>
        <div class ="container">
            <div class ="row">
                <div class ="col-sm-2">    <input type="checkbox" name ="is_t_m_job" id="is_t_m_job"  />         <label for="is_t_m_job">"Is this a T&M Job?" </label>         <br />       </div>
                <div class ="col">   <input type="text" name="t_m_nte_amount" placeholder="NTE AMOUNT $$" size="30" /><br />       </div>
                <div class ="col-lg"></div>
            </div>
        </div>
        <br />         <hr>

        <div class ="container">
            <div class ="row">
                <div class ="col">
                    <label for="contract_status">Contract Status</label>
                    <select id="contract_status" name="contract_status" >
                        <option value="contract_please_select">Please Select Option</option>
                        <option value="contract_received">Contract Received</option>
                        <option value="contract_not_received">Contract Not Received Yet</option>
                        <option value="contract_not_required">Contract Not Required</option>
                    </select>
                </div>
                <div class ="col">
                   <label for="insurance_Status">COI Status</label>
                    <select id="insurance_Status" name="insurance_status" >
                        <option value="COI_please_select">Please Select Option</option>
                        <option value="COI_received">COI Received</option>
                        <option value="COI_not_received">COI Not Received Yet</option>
                        <option value="COI_not_required">COI Not Required</option>
                    </select>
                </div>
                <div class ="col-lg"></div>
            </div>
        </div>
        <br /> <hr>
        <label>Please select company</label>
        <select id="select_company" name="select_company" onChange="filter_estimators()" >
            {% if allclients %}
            {% for client in allclients %}

                <option value="{{client.company}}">{{client.company}}</option>
            {% endfor %}
            {% endif %}
        </select>
        <label for="select_PM">Please select Estimator</label>
        <select id="select_PM" name="select_PM" >


                <option value="please_select">"please select"</option>



        </select>
        <br /> <hr>

    <div id="result">
      <!-- The card name will display here -->
    </div>
    <div id="result1">
      <!-- The card name will display here -->
    </div>
    <div id="result2">
      <!-- The card name will display here -->
    </div>

         <br />
        <input type="submit" value="Book Job Now" />


    </form>


  </body>
</div>
{% endblock %}

