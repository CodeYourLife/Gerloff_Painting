<!DOCTYPE html>
{% load static %}
<html>
<head>
    <script src="{% static 'signature.js' %}">
    </script>
    <style>
        table, td, th {
          border: 1px solid #ddd;
          text-align: left;
        }

        table {
          border-collapse: collapse;
          width: 100%;
        }

        th, td {
          padding: 5px;
        }
    </style>
</head>
<body style="margin: 22px; font-family: Helvetica">
<div>
    <H2>Gerloff Painting Extra Work Ticket</H2>
</div>
<div style="display:flex; justify-content: space-between">
    <div><b>Job:</b>&nbsp;{{changeorder.job_number}}</div>
    <div><b>Change Order #</b>&nbsp;{{changeorder.cop_number}} - {{changeorder.description}}</div>
</div>
<div style="display:flex; justify-content: space-between">
    <div><b>Week Ending Date:</b>&nbsp;{{ewt.week_ending}}</div>
    <div><b>Ticket Completed By:</b>&nbsp;{{ewt.completed_by}}</div>
</div>
<div><p><b>Work Description:</b>&nbsp;{{ewt.notes}}</p></div>
<div style="margin-top: 12px; margin-bottom: 12px;">
    <table style="width: 100%">
        <tr>
            <th>Employee</th>
            <th>M</th>
            <th>T</th>
            <th>W</th>
            <th>Th</th>
            <th>F</th>
            <th>Sat</th>
            <th>Sun</th>
        </tr>
        {% if laboritems %}
        {% for x in laboritems %}
        <tr>
            {% if x.ot == True %}
            <td>{{x.employee}} OVERTIME</td>
            {% else %}
            <td>{{x.employee}}</td>
            {% endif %}
            <td>{{x.monday}}</td>
            <td>{{x.tuesday}}</td>
            <td>{{x.wednesday}}</td>
            <td>{{x.thursday}}</td>
            <td>{{x.friday}}</td>
            <td>{{x.saturday}}</td>
            <td>{{x.sunday}}</td>
        </tr>
        {% endfor %}
        {% else %}
        <tr>
            <td style="text-align: center" colspan="8">No Data To Display</td>
        <tr>
            {% endif %}
    </table>
</div>
<hr style="width:100%">
<div style="margin-top: 12px; margin-bottom: 12px;">
    <div style="width:100%; font-weight: bold; margin-bottom: 12px;">MATERIAL</div>
    <table>
        <tr>
            <th>Description</th>
            <th>Quantity</th>
            <th>Units</th>
        </tr>
        {% if materials %}
        {% for x in materials %}
        <tr>
            <td>{{x.description}}</td>
            <td>{{x.quantity}}</td>
            <td>{{x.units}}</td>
        </tr>
        {% endfor %}
        {% else %}
        <tr>
            <td style="text-align: center" colspan="3">No Data To Display</td>
        <tr>
            {% endif %}
    </table>
</div>
<hr style="width:100%">
<div style="margin-top: 12px; margin-bottom: 12px;">
    <div style="width:100%; font-weight: bold; margin-bottom: 12px;">EQUIPMENT</div>
    <table>
        <tr>
            <th>Description</th>
            <th>Quantity</th>
            <th>Units</th>
        </tr>
        {% if equipment %}
        {% for y in equipment %}
        <tr>
            <td>{{y.description}}</td>
            <td>{{y.quantity}}</td>
            <td>{{y.units}}</td>
        </tr>
        {% endfor %}
        {% else %}
        <tr>
            <td style="text-align: center" colspan="3">No Data To Display</td>
        <tr>
            {% endif %}
    </table>
</div>
<hr style="width:100%">
{% if status == 'NEW' %}
<form action="{% url 'print_ticket' changeorder.id 'NEW' %}" method="post">
    <div>
        <div style="margin-bottom: 12px;"><b>Signature:</b></div>
        {% if signature.signature %}
        <img id="saveSignature" src={{signature.signature}} name="saveSignature" style="width: 300px; height: 100px"
             alt="Saved image png"/>
        <div><b>Name:</b>&nbsp;{{signature.name}}</div>
        <div><b>Date:</b>&nbsp;{{signature.date}}</div>
        <div><b>Comments:</b>&nbsp;{{signature.notes}}</div>
        {% else %}
        <div id="canvas">
            <canvas class="roundCorners" id="newSignature"
                    style="position: relative; margin: 0; padding: 0; border: 1px solid #c4caac;"></canvas>
        </div>
        <div>
            <img id="saveSignature" name="saveSignature" style="display: none; width: 300px; height: 100px"
                 alt="Saved image png"/>
            <div style="display: flex; margin-top: 12px;">
                <div>Print Name:&nbsp;</div>
                <input style="width: 200px" id="signatureName" name="signatureName"></input>
                <input hidden id="signatureValue" name="signatureValue"></input>
            </div>
            <br>
            <label for="gc_notes">Comments:</label><br>
            <textarea id="gc_notes" name="gc_notes" rows="2" style="max-width: 380px; width: 98%;"></textarea>
            <div>{% endif %}
                <div>___________________________________________</div>
            </div>
            <div style="width: 400px">{{changeorder.job_number.client}}</div>
            {% csrf_token %}
            <script>signatureCapture();</script>
            {% if not signature %}
            <button type="button" id="saveSignatureBtn" onclick="signatureSave()">Confirm signature</button>
            <button type="button" id="clearSignatureBtn" onclick="signatureClear()">Clear signature</button>
            <input type="submit" value="Save PDF"/>
            {% endif %}
</form>
{% else %}
<div>_______________________________________________________________</div>
<div style="width: 400px">{{changeorder.job_number.client}}</div>
{% endif %}
</body>
</html>

